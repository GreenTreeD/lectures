# Лекция №1
Вводная лекция... Пупупу.
Будем рассматривать иерархичный подход, разбивая изначальную модель на мелкие элементы(=простые функции). 
 | тут картинка |
 Декомпозиция - разбиение на элементы в рамках одного уровня.
 _Нисходящее проектирование_- от мелких элементов к более сложным.
 _Высходящее проектирование_ - разбиение сложного на мелкие. 

_Пример в электротехнике_
Уровень -> Техническое описание
Базовые элементы: резисторы, конденсаторы, етс -> Описание характеристик
Функциональные узлы: усилитель, фильтр -> Принципиальные схемы
Блоки: модемы, приёмники, етс -> Функциональные схемы
Радиоэлектроенные системы: радиолокационные станции -> Структурные схемы


### Пример проектирования
Есть уровень $i-1$  и ТЗ  для *i*-ого уровня
-> 
Синтез
->
Формирование математической модели
-> 
Расчёт параметров мат. модели (Х - вектор внутренних параметров)
->
Анализ
->
Устраивает ТЗ? 
Если нет, то
1. Изменение внутренних параметров
2. Изменить формирование мат модели
Если да, то *оформление конструкторской документации* -> формирование ТЗ на *i+1*-й уровень.

*Опр.* Проектирование - комплекс мероприятий, направленных на исследование и разработку, с целью выпуска полного комплекта документов. 
Проектирование начинается с формирования ТЗ и заканчивается комплектов документов с полным описанием предмета. В процессе разработки могут появляться промежуточные описания, на основании которых может корректироваться тз и др.
*Опр.* Автоматизированное проектирование - процесс разработки проектных решений при взаимодействии человека с ЭВМ.
*Опр.* Автоматическое проектирование - процесс разработки без участия человека. Человек нужен только при постановке ТЗ и проверке результатов разработки.

Что даёт автоматизированное проектирование.
1. Сокращение сроков разработки
2. Повышение качества
3. Снижение затрат материалов
4. Повышение производительности труда

*Опр.* Проектная процедура - часть этапа проектирования, которая состоит в решении некоторой задачи проектирования и получения проектного решения. *Например: расчёт параметров усилителя*.
*Опр.* Проектная операция - ещё более мелкая часть процесса проектирования, из которых состоит проектная процедура. 

*Опр.* Математическая модель объекта - система математических объектов(числа, переменные, матрицы) и отношений между ними, которая отражает некоторые свойства объекта.

Какие бывают **параметры**:
1. Внутренние (вектор переменных $\vec{X} = (x_1, ... , x_n)$)
2. Выходные (вектор переменных $\vec{Y} = (y_1, ... , y_k)$)
3. Внешние (вектор переменных $\vec{Q} = (q_1, ... ,  q_l)$)
4. Фазовые (вектор переменных $\vec{V} = (v_1, ... v_m)$)
5. Параметры оценки точности(из ТЗ) ($y_i > TT_j^-$, $y_j < TT_J^+$, $TT_j^- < y < TT_j^+$)

*Опр.* Математическое моделирование - получение математической модели и оперирование ею с целью получения сведений о реальном объекте. 

Какие требования мы предъявляем к мат. модели:
1. Точность
	$\delta = |\frac{y_o - y_{mm}}{y_o}|*100\%$
2. Адекватность - способность модели обеспечить достаточную точность в определённых условиях.
3.  Экономичность
4. Универсальность - способность мат. модели быть задействованной в нескольких проектных процедурах. 

## Типовые проектные процедуры 
1. Процедуры анализа
	1. Одновариантный анализ
		1. Расчёт статики
		2. Расчёт динамики
		3. Расчёт устойчивости
		4. Расчёт частотных характеристик
	2. Многовариантный анализ
		1. Расчёт чувствительности
		2. Статистический анализ
2. Процедуры синтеза
	1. Параметрический синтез
		1. Расчёт допусков
		2. Технические требования
		3. Оптимизация параметров
	2. Структурный синтез
		1. Определение физического принципа действия 
		2. Синтез конфигураций

Моделирование имеет 2 задачи: 
1. Создание свойств систем на основе исследования модели
2. Создание моделей сложных систем

Есть два уровня моделирования
1. Микроуровень - системы с распределёнными параметрами
2. Макроуровень - системы с сосредоточенными параметрами
3. Системный уровень - исследования потоков данных (системы массового обслуживания и др.)
# Лекция № 2
## Виды одновариантного анализа
### Анализ статики
Для моделей с распределёнными параметрами будем иметь систему дифференциальных уравнений в частных производных $$F(\frac{\delta v}{\delta x},\frac{\delta v}{\delta y}, \frac{\delta v}{\delta z}, V,X,Q) = 0$$
Для моделей с сосредоточенными параметрами:
$$F(V,X,Q) = 0 $$
### Анализ динамики
Для моделей с распределёнными параметрами:
$$F(\frac{\delta v}{\delta t}, \frac{\delta v}{\delta x},\frac{\delta v}{\delta y}, \frac{\delta v}{\delta z}, V,X,Q, t) = 0$$
Для моделей с сосредоточенными параметрами:
$$F(\frac{\delta v}{\delta t}, V,X,Q,t) = 0$$
### Анализ устойчивости
$$F(\frac{\delta v}{\delta t},V,X,Q, \omega) = 0$$
В частотной области:
$$F(V,X,Q, \omega) = 0$$

## Виды многовариантного анализа
### Анализ чувствительности
Цель такого анализа - определение изменений выходных параметров при заданных изменениях внутренних параметров, т.е. надо найти матрицу чувствительности вида $[\frac{\delta y}{\delta x}]$. Это очень важная задача оптимизации, так как в ходе её решения можно определить, какой внутренний параметр больше всего влияет на выходные параметры.

### Статистический анализ
Цель статистического анализа - определение разброса выходных параметров при известном разбросе внутренних параметров. 

### Параметрический синтез
Цель - задача оптимизации параметров, определение такого вектора внутренних параметров при котором качество изделия максимально. 
![[Pasted image 20250218121224.png]]
### Оптимизация допусков
Цель - определение векторов таких внутренних параметров, при которых качество объектов не хуже заданного, а допуски на внутренние параметры максимальны
![[Pasted image 20250218121543.png]]
### Оптимизация технических требований
Цель - оптимизация технических требований, заданных на систему, в технические требования на элементы.


## Блок-схема преобрзования мат. модели в процессе вычислений
![[Pasted image 20250218122024.png]]

## Методы решения СЛАУ
Точные:
* Метод Гаусса
* Метод L/u-разложений
Приближённые:
* Метод простой итерации
* Метод последовательной релаксации

### Метод Эйлера
Допустим, имеется задача Коши $y' = f(x,y)$, где $y(x_0) = y_0$. Задан некоторый интервал $[a,b]$, на котором мы выбираем точки $x_0, x_i...x_b$. Производная это $y' = \dfrac{\Delta y}{\Delta x} = \dfrac{y(x_{i+1}-y{x_i})}{x_{x+1}-x{i}}=\dfrac{y_{i+1}-y_i}{k}$,где $k = x_i - x_{i-1}$.  Откуда $y(x_{i+1}) = y(x_i)+k*f(x_i,y_i)$. 
|картинка|
Порядок точности такого метода квадратичный $O(k^2)$. 

Если нас такое не устраивает, то можно применить модифицированный метод Эйлера:
ТУТ ИТЕРАЦИИ
### Модифицированный метод Эйлера
Позволяет уменьшить погрешность до $O(h^3)$. 
Напишем ряд Тейлора 3-ого порядка: $y_{i+1} = y_i + y' * h + \dfrac{1}{2}y'' * h^2 + O(h^3)$.
Возьмём апроксимацию для второй производной через первую и подставим: $y''_i = \dfrac{y'_{i+1}-y'_i}{h}$
$$y_{i+1} = y_i + \dfrac{h}{2}[f(x_i,y_i) + f(x_{i+1},y_{i+1})]$$
 Промежуточный:  $\tilde{y_{i+1}} = y_{i}+h*f(x_i,y_i)$ =>
 $$y_{i+1} = y_i = \dfrac{h}{2}[f(x_i, y_i)+f(x_{i+1}, \tilde{y}_{i+1})]$$ Но в этом семестре мы его особо использовать не будем особо
 Приближение на шаге - $O(h^2)$, короче лучше чем у первого метода
### Метод Гаусса
Решается система лин. уравнений $Ax= B$. Путём линейных комбинаций уравнений т.е. строк добиваемся нулей ниже главной диагонали в i-ой строке. Получаем в последней строке равенство вида $x_n \cdot A = B$, поднимаемся обратно, решая уравнения с одним неизвестным.

## .

Для приближённых методов преобразуем $Ax = B$  к виду $x = A'x +B$, чтобы на нескольких итерациях приближения получить решения. 

Матрицы коэффициентов чаще всего являются разреженными. 

## Решения систем НЛАУ
### Метод Ньютона
$$F(x^*) = 0$$ при $x^* = x+\Delta x$. Будем искать поправку $\Delta x$. 
Разложение в ряд Тейлора:
$$F(x+\Delta x) = F(x)+\frac{\delta F(x)}{\delta x}\Delta x + \frac{1}{2!}\frac{\delta^2 F(x)}{\delta x^2} + ... = 0$$

Оставим только первые два члена разложения и получим СЛАУ
$$Я(x)\cdot \Delta x = -F(x)$$$$Я(x) = \frac{\delta F(x)}{\delta x}$$
$$x^{n+1} = x^n + \Delta n$$
Считаем до тех пор, пока не $||\Delta x|| < \delta$, где $\delta$ - точность решения, которую мы задали сами.

При программной реализации стоит указать ограничение на число итераций. 


### Метод Ньютона х2
ТУТ ШАГИ ИНТЕГРИРОВАНИЯ
Пусть у нас есть
$$F(x,y) = 0, G(x,y) = 0$$
Тогда $F(x_k+\Delta x, y_k+\Delta y) = 0$ и $G(x_k+\Delta x, y_k+\Delta y) = 0$, разложим в ряд Тейлора
$$F(x_k + \Delta x, y_k + \Delta y) = F(x_k, y_k) +\dfrac{\delta F(x_k,y_k)}{\delta x}\Delta x_k + \dfrac{\delta F(x_k,y_k)}{\delta y}\Delta y_k = 0$$
$$\dfrac{\delta F(x_k,y_k)}{\delta x}\Delta x_k + \dfrac{\delta F(x_k,y_k)}{\delta y}\Delta y_k = -F(x_k, y_k)$$
Аналогично 
$$\dfrac{\delta G(x_k,y_k)}{\delta x}\Delta x_k + \dfrac{\delta G(x_k,y_k)}{\delta y}\Delta y_k = -G(x_k, y_k)$$Получим матрицу неувязок????
$$Я = \begin{bmatrix} \dfrac{\delta F(x,y)}{\delta x} &\dfrac{\delta F(x,y)}{\delta y} \\ \dfrac{\delta G(x,y)}{\delta x} &\dfrac{\delta G(x,y)}{\delta y} \end{bmatrix}$$

Решение будет иметь вид:
$$Я \begin{bmatrix}\Delta x_k \\\Delta x_y \end{bmatrix} = - \begin{bmatrix} F(x_k,y_k) \\ G(x_k, y_k) \end{bmatrix}$$
Решаем до определённой точности, а если приближение взяли не совсем удачно, то соболезную)))
### Пример
Решаем задачку методов ньютона
$$F(x,y) = 5x^2 - 2xy + 3, G(x,y) = 6x^3y - 2y^2 + 7$$
Производные:
$\dfrac{\delta F}{\delta x} = 10x- 2y$
$\dfrac{\delta F}{\delta y} = -2x$
$\dfrac{\delta G}{\delta x} = 18x^2y$
$\dfrac{\delta G}{\delta y} = 6x^3 - 4y$

Обозначим $\Delta x = \begin{bmatrix} \Delta x \\ \Delta y\end{bmatrix}$
Возьмём за первое приближение $x_0 = 1, y_0 = 1, \epsilon = 1$ 
$$\begin{bmatrix}8 & -2 \\18 & 2 \end{bmatrix} \begin{bmatrix}\Delta x \\ \Delta y\end{bmatrix}\cdot = - \begin{bmatrix} 6\\ 11\end{bmatrix}$$
$$\begin{bmatrix}\Delta x \\ \Delta y\end{bmatrix} = $$

### Метод касательных
а.

### Пример

# Лекция №3
Математическая модель

Граничные условия в нулевой момент времени уже существуют.

## Постановка двухмерной стационарной задачи
/картинка/
$LV+P=0$, где $L = \frac{d}{dx}+\frac{d}{dy}$

Различают граничные условия:
1. Первого рода, когда на границе задано значение фазовой переменной. 
2. Второго рода или типа Неймана, когда на границе задан поток фазовой переменной.
3. Третьего рода, которые включают в себя и поток фазовой переменной, и саму фазовую переменную.
Задача заключается в нахождении $V$. Для решения таких задач может использоваться:
1. Метод конечных разностей
2. Метод конечных элементов
3. Метод граничных элементов
Метод граничных элементов можно использовать в том случае, если известно сингулярное решение дифференциального оператора. (если известно аналитическое решение этого дифференциального оператора на бесконечной области при единичном возмущении)

## Метод конечных разностей
Основная идея этого метода заключается в замене дифференциального оператора его разностным аналогом на некотором ограниченном наборе точек исходного непрерывного пространства. Этот набор точек называется *сеткой*.

### Как идёт замена частных производных
$$\frac{dv(x)}{dx} \approx \frac{v(x+ \Delta x)-v(x)}{\Delta x}$$
$\dfrac{v_{i+1}-v_i}{\Delta x}$ - правая разность. $\dfrac{v(x)-v(x-\Delta x)}{\Delta x}$ - левая разность, $\dfrac{v(x + \Delta x)-v(x-\Delta x)}{2\Delta x}$ центральная разность.

В МКЭ аппроксимируются *производные*.
Правая разность имеет первый порядок точности, левая разность имеет первый порядок точность, центральная разность - второй. 

Рассмотрим вторую производную:
$$\frac{\delta^2v}{\delta x^2}=\dfrac{\delta}{\delta x}(\dfrac{\delta v}{\delta x}) = \dfrac{\dfrac{v_{i+1}-v_i}{\Delta x}-\dfrac{v_{i}-v_{i-1}}{\Delta x}}{\Delta x} = \dfrac{v_{i+1}-2v_i+v_{i-1}}{\Delta x^2}$$
Второй порядок точности.

Третья производная:
$\dfrac{\delta^3v}{\delta x^3}=\dfrac{\delta}{\delta x}\Bigl(\dfrac{v_{i+1}-2v_i+v_{i-1}}{\Delta x^2}\Bigr)=\dfrac{\dfrac{v_{i+1}-2v_i+v_{i-1}}{\Delta x^2}-\dfrac{v_i-2_{i-1}+v_{i-2}}{\Delta x^2}}{\Delta x^2}=$

Четвёртая производная:

Пример:
/формулка/

# Лекция №4
## Одномерные не линейные задачи.
	1. Когда завист от координат функции материалов
	2. Когда зависит от внутренних свойств
### Оценка эффективности двойного стекла.

$$ K_C = \cdot K_B$$$$\frac{\delta}{\delta x}k\frac{\delta T}{\delta x}=0$$
Для первого узла $$\dfrac{K_В\dfrac{T_2-T_1}{\Delta x}-K_c\cdot\dfrac{T_1-T_0}{\Delta x}}{\Delta x} = 0$$
Для второго узла:
$$ \dfrac{T_3-2T_2+T_1}{\Delta x^2}=0$$
($K_B$ опускается в уравнении для второго узла)
Для третьего узла:
$$\dfrac{K_C\cdot\dfrac{T_4-T_3}{\Delta x}-K_B\cdot\dfrac{T_3-T_2}{\Delta x}}{\Delta x}=0$$
Решаем систему из этих трёх уравнений.

### Задача 2
$\dfrac{\delta}{\delta x}k\dfrac{\delta T}{\delta x}=0$ при $k = T$.

Для первого узла:
$$\dfrac{T_2\cdot\dfrac{T_2 - T_1}{\Delta x} - T_1\cdot\dfrac{T_1 - T_0}{\Delta x}}{\Delta x} = 0$$
Для второго узла:
$$ \dfrac{T_3 \cdot \dfrac{T_3 - T_2}{\Delta x} - T_2 \cdot \dfrac{T_2 - T_1}{\Delta x}}{\Delta x} = 0$$

$T_2^2 - T1\cdot T_2 - T_1^2 + T_1\cdot T_0 = 0$
$T_3^2 - T_3 \cdot T_2 - T_2^2 + T_2\cdot T_1 = 0$

Получается система нелинейных уравнений. Решается методом Ньютона.

## Двумерные задачи

### Задача 1
![[Pasted image 20250304123145.png]]
$$ \frac{\delta^2 T}{\delta x^2}+\frac{\delta^2 T}{\delta y^2} = 0$$
Для узла 1.1:

$$\frac{T_{21} - 2T_{11}+T_{01}}{\Delta x^2} + \frac{T_{12}-2T_{11}+T_{10}}{\Delta y^2} = 0$$
Для узла 2.1:
$$\frac{T_{31} - 2T_{21}+T_{11}}{\Delta x^2} + \frac{T_{22}-2T_{21}+T_{20}}{\Delta y^2} = 0$$
Для узла 2.2:
$$\frac{T_{32} - 2T_{22}+T_{12}}{\Delta x^2} + \frac{T_{23}-2T_{22}+T_{21}}{\Delta y^2} = 0$$Для узла 1.2:
$$\frac{T_{22} - 2T_{12}+T_{02}}{\Delta x^2} + \frac{T_{13}-2T_{12}+T_{11}}{\Delta y^2} = 0$$

Граничные условия:
$T_{10} = 20$, $T_{20} = 20$, $\dfrac{T_{31} - T_{21}}{\Delta x} = 0$, $\dfrac{T_{32} - T_{22}}{\Delta x} = 0$, $\dfrac{T_{12}-T_{13}}{\Delta y} = T_{13}$, $\dfrac{T_{22} - T_{23}}{\Delta y} = T_{23}$, $T_{01} = 10$, $T_{02} = 10$.

*Каких условий нет в одномерных, которые есть в двумерных задачах?*
Непопадание границ в узлы сетки))) гыгыгы

### Границы неправильной формы
$0<\mu < 1$ 
$$(1)\qquad V(x+\Delta x) = V(x)+\frac{\delta V}{\delta x}\Delta x+ \frac{1}{2!}\frac{\delta^2 V}{\delta x^2}\Delta x^2 + ...$$
$$(2)\qquad V(x-\mu \Delta x) = V(x) - \mu \frac{\delta v}{\delta x} \Delta x + \frac{\mu ^2}{2!}\frac{\delta^2 V}{\delta x^2}\Delta x^2 - \frac{\mu ^3}{3!}\frac{\delta^3 V}{\delta x^3}\Delta x^3 + ...$$
$$(1)\cdot \mu ^2 - (2)$$
$$\mu ^2 V_C - V_A = (\mu ^2 - 1)V_B + (\mu^2 - \mu)\frac{\delta V}{\delta x}\Delta x$$
$$\frac{\delta V}{\delta x} = \frac{\mu ^2 V_c - (\mu^2 - 1)V_b - V_A}{(\mu ^2 - \mu)\Delta x}$$
$$(1)\cdot \mu + (2)$$
$$\mu V_C + V_A  = (\mu + 1)V_B + \frac{\mu^2 + \mu }{2}\frac{\delta^2 V}{\delta x^2}\Delta x^2$$
$$\frac{\delta ^2 V}{\delta x^2} = 2\frac{\mu V_C - (\mu + 1)V_B + V_A}{(\mu^2 + \mu)\Delta x^2}$$

# Лекция № 5
Решение нестационарных задач методом конечных элементов

$$\frac{\delta T}{\delta t} = a \frac{\delta^2 T}{\delta x^2}$$
Надо задавать начальные условия: $T(t=0)=0^o$
Нижний индекс по пространству, верхний по времени
Производная: $\dfrac{T_i^{j+1}-T_i^j}{\Delta t} = a\dfrac{T_{i+1}^j - 2T_i^j + T_{i-1}^j}{\Delta x^2}$
$\Delta x = 1$, $\Delta t = 1$, $a = 1$.

Первый временной слой:
    узел 3.1: $\dfrac{T_1^1 - T_1 ^0}{\Delta t} = a\dfrac{T^0_2 - 2T^0_1 + T_0^0}{\Delta x^2}$ => $T_1^1 = 0$
    узел 3.2: $\dfrac{T_2^1 - T_2^0}{\Delta t} = a\dfrac{}{}$ => 

Второй временной слой:

Третий временной слой:


Явные разностные схемы являются неустойчивыми и при превышении некоторого критического значения шага по времени погрешность вычислений стремительно возрастает. 
Условие устойчивости конкретно для этой задачи:
 $$\Delta t \le \frac{\Delta x^2}{2a}$$
При правильном временном шаге:
    Первый временной слой:
        узел 1: $\dfrac{T_1^1 - T_1 ^0}{\Delta t} = a\dfrac{T^0_2 - 2T^0_1 + T_0^0}{\Delta x^2}$ => $T_1^1 = 0$
        узел 2: $\dfrac{T_2^1 - T_2^0}{\Delta t} = a\dfrac{T_2^0 - 2T_2^0 + T_1^0}{\Delta x^2}$ => $T_2^1 = 10$

## Алгоритм автоматического выбора шага
1. Вводим константу, физический смысл которой - *максимальное изменение наиболее быстро меняющейся переменной* - $\delta$.
	$\delta = 2$
2. Рассчитываем вектор производных по времени (всех производных по времени).
	узел 1 : $\dfrac{\delta T}{\delta t} = a\cdot \dfrac{T_2^0 - 2T_1 ^0 +T_0^0}{\Delta x^2} = 0$
	узел 2: $\dfrac{\delta T}{\delta t} = a\cdot \dfrac{T_2^0 - 2T_1 ^0 +T_0^0}{\Delta x^2} = 100$
3. Находим норму $||\dfrac{\delta V}{\delta t}||$ (max $|\dfrac{\delta V}{\delta t}| = 100$)
4. Рассчитываем шаг по времени $\Delta t = \frac{\delta}{||\frac{\delta V}{\delta t}||} = \frac{2}{100} = 0.02$
5. Рассчитываем переменные на новом шаге по времени: $$\frac{\delta T_1}{\delta t} = \frac{T_1^1 - T_1^0}{\Delta t} => T_1^1 = 0$$ $$\frac{\delta T_2}{\delta t} = \frac{T_2^1 - T_2^0}{\Delta t} => T_2^1 = 2$$
## Учёт граничных условий 2-ого и 3-ого рода в разностных схемах
Нам нужны в нулевой момент времени значения в узлах, так как есть граничные условия второго или третьего рода.
![[Pasted image 20250311122931.png]]

## Ыщо одно одно измерение 
![[photo_2025-03-11_12-30-40.jpg]]
$$\frac{T_{11}^1 - T_{11}^0}{\Delta t} = a_1\cdot \frac{T_{21}^0-2T_{11}^0+T_{01}^0}{\Delta x^2}+a_2 \cdot \frac{T_{12}^0 - 2T_{11}^0 + T_{10}^0}{\Delta y^2}$$

При $a_1 = 1$, $a_2 =1$.

# Лекция №6
![[Pasted image 20250318120327.png]]
$$\frac{\delta T}{\delta t}=a\frac{\delta^2T}{\delta x^2},\Delta x=1,\Delta t=1,a=2$$
![[Pasted image 20250318120345.png]]![[Pasted image 20250318120617.png]]
![[Pasted image 20250318120630.png]]
## Cхемы 
Чем больше шаг интегрирования тем  больше погрешность, но погрешность всё равно ограничена.
Неявные условия граничного 2-го и и 3-рода
![[Pasted image 20250318120912.png]]
Явные это первого рода
Неявные это второго  и третьего рода.
Пример для второго:
![[Pasted image 20250318121039.png]]
Пример для третьего рода рода
![[Pasted image 20250318121454.png]]
### Пример колебания струны (2 мерный случай) 
явную и не явная схема:
$$\frac{\delta^2V}{\delta t^2}=a\frac{\delta ^2 v}{\delta x ^ 2}$$
$$\frac{V_i^{j+1}-2V_i^j+V_i^{j-1}}{\Delta t} = a\frac{V_{i+1}^{j}-2V_i^j+2V_{i-1}^j}{\Delta x^2}$$
Начальные условия: $V(t = 0) = 0$, $\frac{d}{dt}(t= 0) = \frac{dV}{dt}h$

$$\frac{V_i^{j+1}-2V_i^j+V_i^{j-1}}{\Delta t} = \frac{a}{2}\cdot\Big(\frac{V_{i+1}^{j}-2V_i^j+2V_{i-1}^j}{\Delta x^2}+\frac{V_{i+1}^{j+1}-2V_i^{j+1}+V_{i-1}^{j+1}}{\Delta x^2}\Big)$$

##
Смысл двумерной задачи - появляется плоский объект, надо определить поле фазовой переменной, которая меняется во времени
$$\frac{\delta T}{\delta t} = a_1 \cdot \frac{\delta^2 T}{\delta x^2} + a_2 \cdot \frac{\delta ^2 T}{\delta x^2}$$
Явная(1 неизвестный):
$$\frac{T_{i,j}^{k+1}- T_{i,j}^{k}}{\Delta t} = a_1 \cdot\frac{T_{i+1, j}^{k}-2T_{i,j}^k - T_{i-1, j}^{k}}{\Delta x^2}+a_2 \cdot \frac{T_{i, j-1}^k - 2T_{i,j}^k - T_{i, j-1}^k}{\Delta y^2}$$
Неявная(5 неизвестных):
$$\frac{T_{i,j}^{k+1}- T_{i,j}^{k}}{\Delta t} = a_1 \cdot\frac{T_{i+1, j}^{k+1}-2T_{i,j}^{k+1} - T_{i-1, j}^{k+1}}{\Delta x^2}+a_2 \cdot \frac{T_{i, j-1}^{k+1} - 2T_{i,j}^{k+1} - T_{i, j-1}^{k+1}}{\Delta y^2}$$
Если объект симметричен геометрически и по граничным начальным условиям, то размерность задачи можно сократить кратно в соответствии с числом оси симметрии.

### Пример:


# Лекция №5
## Методы расщипления
Есть уравнение:
$$\frac{\delta v}{\delta t} = a_1\cdot \frac{\delta^2 v}{\delta x^2} + a_2\cdot \frac{\delta^2 v}{\delta y^2}$$
Решив отдельно следующие уравнения можно с некоторой точностью получить решение первого уравнения:
$\dfrac{\delta v}{\delta t} = a_1\cdot \dfrac{\delta^2 v}{\delta x^2}$ и $\dfrac{\delta v}{\delta t} = a_2\cdot \dfrac{\delta^2 v}{\delta y^2}$ 

$\dfrac{W_{i,j}^{t+1}-W_{i,j}^t}{\Delta t} = a_1 \cdot \dfrac{W_{i+1, j}^{t+1}-2W_{i,j}^{t+1}+W_{i-1,j}^{t+1}}{\Delta x^2}$
$W_{i,j}^{t} = T_{i,j}^t$
$\dfrac{W_{i,j}^{t+1}-W_{i,j}^t}{\Delta t} = a_1 \cdot \dfrac{W_{i, j+1}^{t+1}-2W_{i,j}^{t+1}+W_{i,j-1}^{t+1}}{\Delta y^2}$

Получается трёхдиагональная матрица, которую легче всего решить методом прогонки. 
Если получилась не диагональная, надо взять другие номера для узлов хд

## Сходимость, устойчивость, аппроксимация разностных схем
$$LV+P = 0$$
Это исходных дифференциальный оператор.
А это оператор на сетке: $L_n V_n + P_n = 0$
Норма: $||v-v_n|| \leq ch^k$
Если норма следующей увязки такому неравенству, то имеет место сходимость
$||\delta_n||\leq ch^k$ => $L_n V(h) + P_n = \delta_n$

*Опр.* Аппроксимация Ричардсона.
Если знаем порядок разностной схемы, то $\dfrac{V_T - V_{n_1}}{V_T - V_{n_2}} = \Big(\dfrac{h_1}{h_2}\Big)^k$
$h_1$ и $h_2$ - кратные шаги.

## Метод конечных элементов

Раньше был метод взвешенных невязок, сейчас его рассмотрим
$LV+P = 0$ и граничные условия первого рода $V(r) = V_r$
Можно попробовать подобрать функцию $V$, которая будет удовлетворять всем усорвиям))))
Получаем
$v = \psi + \sum_{m=1}^{M}a_m N_m$
$\psi$ удовлетвлетворяет граничным условиям, а $N_m$ - пробные функции, равные 0 на границе.
$$L(\psi + \sum_{m=1}^{M}a_m N_m) + P = R$$
$R$ - невязка.
$\int_{\Omega} W_l\cdot R d\Omega = 0$
$W_l$  - весовая ф-ция, чтобы интеграл не был равен 0, если площади сокращаются.
Если кол-во $W_l$ столько же, сколько пробных функций, то получаем систему уравнений относительно коэффициентов $a_m$.
$$k\cdot a + Q = 0$$
Получаем
$$\int_{\Omega}W_l\cdot(L(\psi + \sum_{m=1}^{M}a_m N_m)+P)d \Omega = 0$$
Отсюда выводим:
$$k_{ij} = \int_{\Omega}W_i\cdot L \cdot N_j d \Omega$$
$$Q_i = \int_{\Omega}W_i(L \psi + P)d \Omega$$

### Пример

Функция, удовлетворяющая граничным условиям:  $\psi = 100x$
Функции, не мешающие на границе: $N_m = x^m(1-x)$
$N_1 = x(1-x)$, $N_2 = x^2(x-1)$
Таким образом аппроксимация будет выглядеть вот так:
$T = 100x + a_1 x(1-x)+a_2x^2(1-x)$
<br>
	По типу выбора весовых функций, различают:
	1. Метод неточной коллокации (используют вместо неё дельта функцию)
	2. Метод коллокации по областям 
	3. Метод Галёркина
Будем использовать 3 метод

$W_1 = x(1-x)$, $W_2 = x^2(1-x)$
Получаем:
$K_{11} = \int_0^1 x(1-x)\cdot\dfrac{d^2}{dx^2}(x(1-x))dx =-\dfrac{1}{3}$
$K_{12} = \int_0^1 x(1-x)\cdot \dfrac{d^2}{dx^2}(x^2(1-x))dx = -\dfrac{1}{6}$
$K_{21} = \int_0^1 x^2(1-x)\cdot \dfrac{d^2}{dx}(x(1-x))dx = -\dfrac{1}{3}$
$K_22 = \int_0^1 x^2 (1-x) \cdot \dfrac{d^2}{dx^2}(x^2(1-x))dx = -\dfrac{2}{15}$
И
$Q_1 = \int_0^1 x(x-1)(\dfrac{d^2}{dx^2}100x)dx =\dfrac{100}{3}$
$Q_2 = \int_0^1 x^2(1-x)(\dfrac{d^2}{dx^2}100x)dx = \dfrac{100}{6}$
Решение:
$$\begin{bmatrix} -\frac{1}{3} & -\frac{1}{6}\\ -\frac{1}{6} & -\frac{2}{15} \end{bmatrix} \cdot \begin{bmatrix} a_1 \\ a_2 \end{bmatrix} + \begin{bmatrix} \frac{100}{3} \\ \frac{100}{6} \end{bmatrix} = \begin{bmatrix} 0 \\ 0 \end{bmatrix}$$ 
Получилось однородное решение.


# Лекция №7

{картинка}

$$-\begin{bmatrix}\frac{1}{L} & -\frac{1}{L}\\-\frac{1}{L} & \frac{1}{L} \end{bmatrix}\cdot\begin{bmatrix}T_i \\ T_j\end{bmatrix} + \begin{bmatrix}-\frac{\delta T}{\delta x}_i \\ \frac{\delta T}{\delta x}_j \end{bmatrix} = 0$$
Перемножим всё это безобразие и получим следующую штуку
$$\begin{bmatrix}\frac{1}{L_1} & -\frac{1}{L_1} & 0 & 0 \\ -\frac{1}{L_1} & \frac{1}{L_1}+\frac{1}{L_2} & -\frac{1}{L_2}& 0 \\ 0 & -\frac{1}{L_2}& \frac{1}{L_2}+\frac{1}{L_3} & -\frac{1}{L_3}\\ 0 & 0 & -\frac{1}{L_3} & \frac{1}{L_3}\end{bmatrix}\cdot \begin{bmatrix}T_0 \\ T_1 \\ T_2 \\ T_3 \end{bmatrix} = \begin{bmatrix}\dfrac{\delta T}{\delta x}\bigg\vert_0 \\ 0 \\ 0 \\ -\dfrac{\delta T}{\delta x}\bigg\vert_3\end{bmatrix}$$
Но производные мы тоже не знаем, поэтому надо тоже внести их в столбец неизвестных с помощью
$$\begin{bmatrix}\frac{1}{L_1} & -\frac{1}{L_1} & 0 & 0 & -1 & 0 \\ -\frac{1}{L_1} & \frac{1}{L_1}+\frac{1}{L_2}\end{bmatrix}$$

## Функции-формы высших порядков
Как получить функцию форму квадратичных элементов....
$T = a_0 + a_1x + a_2 x^2$

$x = 0$ => $T_j = a_0$
$x = \frac{L}{2}$ => $T_i = a_0 + a_1 \frac{L}{2}+a_2\frac{L^2}{4}$
$x = L$ => $T_k = a_0 + a_1 \cdot L + a_2 \cdot L^2$
Найдём значения коэффициентов $a$:
$a_0 = T_j$
$a_1 = \dfrac{4T_i - T_k - 3 T_j}{L}$
$a_2 = \dfrac{-4T_i + 2 T_j + 2T_k}{L^2}$
Подставим в формулу $T(x)$:
$$T = T_j + \dfrac{4T_i - T_k - 3 T_j}{L} \cdot x + \dfrac{-4T_i + 2 T_j + 2T_k}{L^2} \cdot x^2$$
$$T = T_i \cdot \Big(\frac{4x}{L}-\frac{4x^2}{L^2}\Big)+T_j \cdot \Big(1 - \frac{3x}{L}+\frac{2x^2}{L^2} \Big)+T_k \cdot \Big(-\frac{x}{L}+\frac{2x^2}{L^2}\Big)$$

Решим следующую задачу, используя этот ужас:
$$\int_0^LN_e^T\frac{\delta^2T}{\delta x^2}dx = 0$$
$$\int_0^L\begin{bmatrix}\frac{4x}{L} - \frac{4x^2}{L^2}\\  1 - \frac{3x}{L}+\frac{2x^2}{L^2} \\ -\frac{x}{L}+\frac{2x^2}{L^2} \end{bmatrix} \cdot \frac{\delta^2}{\delta x^2}\begin{bmatrix}(\frac{4x}{L}-\frac{4x^2}{L^2});(1 - \frac{3x}{L}+\frac{2x^2}{L^2});(-\frac{x}{L}+\frac{2x^2}{L^2})\end{bmatrix}\cdot \begin{bmatrix}T_i \\ T_j \\ T_k\end{bmatrix}dx = 0$$
$$\int_0^L\begin{bmatrix}\frac{4x}{L} - \frac{4x^2}{L^2}\\  1 - \frac{3x}{L}+\frac{2x^2}{L^2} \\ -\frac{x}{L}+\frac{2x^2}{L^2} \end{bmatrix} \cdot \begin{bmatrix}-\frac{8}{L^2};\frac{4}{L^2};\frac{4}{L^2}\cdot\end{bmatrix}\begin{bmatrix}T_i \\ T_j \\ T_k\end{bmatrix}dx = 0$$
Короче это всё надо перемножить и посчитать три отдельных интеграла для $T$. 
$$\begin{bmatrix}\frac{16}{3L} & \frac{8}{3L} & \frac{8}{3L} \\ -\frac{4}{3L} & \frac{2}{3L} & \frac{2}{3L} \\ -\frac{4}{3L} & \frac{2}{3L} & \frac{2}{3L} \end{bmatrix}\cdot\begin{bmatrix}T_i \\ T_j \\ T_k\end{bmatrix} = 0$$
Получили мат модель конечного элемента. 

Теперь ансамблирование.....
<картинка>

Математические модели конечных элементов, у которых есть внутренние узлы, можно редуцировать, выполняя прямой ход Гаусса для внутренних узлов. 
Ансамблированию подлежит подматрица, соответствующая внешним узлам конечных элементов. После нахождения значения для внешних узлов значения для внутренних узлов можно получить, выполняя обратный ход гаусса для каждого конечного элемента. 

# Лекция №8

$v = a_0 + a_1 \cdot x + a_2\cdot x^2 +a_3 \cdot x^3 + a_4 \cdot x^4$

## Двумерный случай МКЭ, линейный случай
![[1.png]]
$v = a_0 + a_1 \cdot x + a_2 \cdot y$

$v_i = a_0 + a_1 \cdot x_i + a_2 \cdot y_i$
$v_j = a_0 + a_1 \cdot x_j + a_2 \cdot y_j$
$v_k = a_0 + a_1 \cdot x_k + a_2 \cdot y_k$

Получаем $a_0, a_1, a_2$
Дальше все тоже самое, что в одномерном случае

![[Pasted image 20250423130712.png]]
![[Pasted image 20250423131001.png]]

## Двумерный случай МКЭ, нелинейный случай
Минимальные нелинейные элементы:
![[Pasted image 20250423141139.png]]

#  Лекция
Интегрирование на макро уровне

*Опр.* Математической моделью на макро уровне является система обыкновенных дифференциальных уравнений с заданными начальными параметрами(???).

Основной акцент переносится на получение математической модели, а не на решение задачи. 

В результате дискретизации объекта по определённым элементам появляется структура объекта, отобразить которую можно либо с помощью графа, либо с помощью эквивалентной схемы.
Ветви графа это элементы, узлы - места соединений.
Как следствие появления структуры, можно различать 2 типа фазовых переменных. 
Это переменные типа *потенциала*, соответствующие узлам, и переменные типа *потока*, соответствующие ветвям(задаются стрелочками).

На макро уровне различают два типа уравнений. Это *компонентные* уравнения, которые описывают состояния ветви и, как правило, включают в себя разнородные фазовые переменные, и *топологические* уравнения, основывающиеся на уравнениях равновесия и непрерывности, и относятся к нескольким элементам системы. 

{картинка}

Матрица инценденции А:

| \   | a   | b   | c   | d   | e   |
| --- | --- | --- | --- | --- | --- |
| 1   | 1   | -1  |     |     | 1   |
| 2   | -1  | 1   | 1   | 1   |     |
| 3   |     |     | -1  | -1  | -1  |

Втекающий поток - положительный, вытекающий - отрицательный.

$$A\cdot I = 0$$
(Получаем закон Кирхгофа, но нахуя....)

$I_a - I_b + I_e = 0$ и тд....

Но такое мы использовать не будем))))))).

## Кодировка с помощью М-матрицы
В графе нужно выбрать фундаментальное дерево.
В М-матрице столбцы соответствуют ветвям дерева, а хорды(не вошедшие ветви графа) - строкам. 
Заполнение матрицы, для всех строк: временно включаем хорду в дерево, получаем замкнутый контур. Выполняется обход этого контура в направлении, заданном хордой. 
0 - ветвь не вошла в контур(обычно не ставится, чтобы легче читать матрицу),
+1 - если направление контура совпадает с направлением хорды
-1 - если направление контура не совпадает с направлением хорды

| /   | a   | d   |
| --- | --- | --- |
| с   |     | -1  |
| b   | +1  |     |
| e   | -1  | -1  |


Топологические уравнения:
$M\cdot U_{вд}+U_x = 0$
$I_{вд}-M^t\cdot I_x = 0$
U - переменная типа потенциала, I - переменная типа потока, индекс вд относится к ветвям дерева, а x - хордам. 

Для потенциала:

$$\begin{bmatrix}0 & -1 \\ 1 & 0 \\ -1 & -1\end{bmatrix}\cdot \begin{bmatrix}U_a \\ U_d\end{bmatrix} + \begin{bmatrix}U_c \\ U_b \\ U_e \end{bmatrix} = 0$$
Отсюда получаем $U$, что очевидно.

Для потока:
$$-\begin{bmatrix}0 & 1 & -1 \\ -1 & 0 & -1\end{bmatrix}\cdot \begin{bmatrix}I_c \\ I_b\\ I_e \end{bmatrix}+\begin{bmatrix}I_a \\ I_d\end{bmatrix} = 0$$

$I_a - I_b + I_c = 0$
$I_d + I_c + I_e = 0$
М-матрица называется матрицей *контуров и сечений*.

Ыщо один пример:

| /   | a   | c   | e   |
| --- | --- | --- | --- |
| b   | -1  |     |     |
| d   |     | -1  |     |
| f   |     |     | -1  |
| g   | -1  | -1  | -1  |
| h   | -1  | -1  | -1  |

Для потенциала:

$$\begin{bmatrix}-1 & 0 & 0 \\ 0 & -1 & 0 \\ 0 & 0 & -1 \\ -1 & -1 & -1 \\ -1 & -1 & -1\end{bmatrix}\cdot \begin{bmatrix}U_a \\ U_c \\ U_e\end{bmatrix} + \begin{bmatrix}U_b \\ U_d \\ U_f \\ U_g \\ U_h \end{bmatrix} = 0$$
СЛАУ:
$$\begin{align}-U_a + U_b = 0 \\ -U_c + U_d = 0 \\ -U_e + U_f = 0 \\ -U_a - U_c -U_f + U_g = 0\\ - U_a - U_c - U_f - U_h = 0\end{align} $$


Для потока:
$$-\begin{bmatrix}0 & 0 & -1 & -1 & -1\\ 0 & -1 & 0 & -1 & -1 \\ -1 & 0 & 0 & -1 & -1\end{bmatrix}\cdot \begin{bmatrix}I_b \\ I_d\\ I_f \\ I_g \\ I_h \end{bmatrix}+\begin{bmatrix}I_a \\ I_c \\ I_e\end{bmatrix} = 0$$


## Компонентные уравнения
Вопрос получения компонентных уравнений - вопрос, которым занимаются прикладные направления. 
Т.е. это процедура неформальная

Способы получения:
1. Теоретический.
	Можем взять уравнение явления и попробовать его привести 
2. Физический эксперимент / Метод чёрного ящика
	По внешним проявлениям физических явлений внутри объекта пытаемся понять чё там происходит
3. Математический эксперимент или моделирование на микроуровне
	Берём уравнение в частных производных и пытаемся решить задачу микроуровня

Короче говоря, компонентные уравнения это данность, они должны быть известны *до* моделирования.

### Физические однородные подсистемы
Выделим физические однородные подсистемы, с которыми мы будем работать.
1. Механическая поступальная
2. Механическая вращательная
3. Электрическая
4. Гидравлическая закрытая (пневматическая)
5. Гидравлическая открытая
6. Тепловая
7. Магнитная
Ещё есть оптическая но мы её не пишем патамушта

### Аналогии физических однородных подсистем на уровне компонентных уравнений

В большинстве рассмотренных подсистем можно выделить 3 пассивных элемента и 2 активных.
Пассивные:
1. Элемент потерь
2. Элемент на котором запасается потенциальная энергия
3. Элемент на котором запасается кинетическая энергия

Активные: источники фазовых переменных
1. Типа потока
2. Типа потенциала

Их достаточно, чтобы получить мат модель для каждой подсистемы



# Лекция
